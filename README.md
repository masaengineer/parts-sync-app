# Parts Sync | 越境 EC 販売者のための管理会計 SaaS

[![Image from Gyazo](https://i.gyazo.com/3a721fbb896e886a8c4ef51df114f372.jpg)](https://gyazo.com/3a721fbb896e886a8c4ef51df114f372)

**「Parts Sync」** は、越境 EC 販売者の管理会計をサポートする SaaS です。<br>
散らばったデータを少ない工数で一元管理でき、タイムリーな意思決定による売上向上を支援します。
<br><br><br>

## Why - なぜこのツールを開発するのか

### 個人事業時代の課題

輸出 EC 販売に 6 年間従事した経験から、ニッチな市場には SaaS が行き届いていないこと実感していました。労働集約型ビジネスモデルでは、事業主の時間や体力のリソース制限が業績の上限となるケースが数多く存在します。

### データ管理の非効率性

販売戦略の意思決定に必要な商品単位の利益の集計は日次業務として重要ですが、複数のスプレッドシートに分散管理された情報を関数で突合する方法は事業拡大フェーズでは煩雑で非現実的でした。

### 「Parts Sync」の企画

「もっとこんなツールがあればいいのに...」という思いから生まれた「Parts Sync」は、日次作業の業務効率化で事業者のリソースを増やし、迅速な意思決定をサポートして販売機会の向上を支援します。

### ユーザー中心の開発アプローチ

カーパーツを輸出販売する知人の課題に共感し、企画段階から要求をヒアリングしながら仕様を固めました。ユーザーが要望する機能をそのまま開発するのではなく、「**ユーザーが本質的に望んでいる機能は何か**」を意識し、開発コストと要求の充足度を比較検討しながら開発を進めました。
<br><br><br>

## How - どのように課題解決するか

### ペルソナ

年商 3,000 万円〜数億円規模の越境 EC 事業者<br>

#### ユーザーが抱える課題：

- 日々変動する要因（仕入価格、為替、競合他社等）に対応し、競争力のある適正価格で販売するためには、商品単位の原価管理が必須である
- 現状は、仕入代金、各プラットフォームの手数料、国内外の送料、各種外注費、為替情報などが**複数のスプレッドシートで分散管理されている**
- データ更新の漏れや整合性の欠如が頻発してしまっており、**月平均で 30〜50 時間の工数**がかかっている

#### 解決策：

- 最適化されたデータベースを導入し、商品代金、手数料、送料、外注費などの**情報を一元管理**する
- Web アプリで提供し、直感的で複雑性を排除した UI とすることで容易にスタッフ間で情報共有することが可能
- 日次の集計作業にかかる工数を大幅に削減し、**年間 100 万円規模のコストカット**\*を実現<br>（※時間単価 3 千円、月 30 時間削減の場合の試算）

### 業界特化型の機能設計

- 海外販売プラットフォーム eBay との API 連携対応し、**1 時間ごとの自動注文取り込み機能を実装**
- 国際取引にまつわる多通貨（USD, CAD, EUR, GBP, AUD）へ対応

### 新規ユーザーの獲得方法

- **MVP リリース：** テストユーザーによる検証と改善
- **本リリース：** カーパーツ販売者のコミュニティを通じた営業、既存ユーザーによる口コミ紹介
  <br><br><br>

## What - 何を具体として提供するのか <br>

### 主な機能

| カテゴリ         | 機能                                                                                                                                                                                                          |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **売上レポート** | ・eBay API 連携による受注情報自動取得<br>・CSV 取り込み<br>・販売商品一覧と詳細表示<br>・検索/フィルタリング機能<br>・降順昇順並び替え<br>・ページネーション<br>・価格調整メモ<br>・多通貨対応                |
| **月次レポート** | ・年間業績グラフ表示<br>・経費入力/管理                                                                                                                                                                       |
| **全般**         | ・ユーザー登録/認証<br>・Google ログイン<br>・マイページ<br>・ダークモード<br>・オンラインツアーガイド<br>・ローディングアニメーション<br>・デモユーザー体験<br>・静的 OGP<br>・利用規約/プライバシーポリシー |

### 主要機能のデモ

<table>
<tr>
<td width="50%">

#### 📥 売上レポート機能

<details>
<summary>詳細（クリックして表示）</summary>
委託先の情報を管理しているスプレッドシートから外注費データをCSV形式で効率的にデータベースへインポートすることができます。加えて、海外販売プラットフォームeBayが提供する公式APIとの連携により、注文情報は1時間ごとに自動で同期されます。この定期的な自動更新処理は、バックグラウンドジョブ管理のためにSidekiqとRedisを採用し、`sidekiq-scheduler`を用いて定期実行を実現しています。<br>当初は通常のWebサーバーで同期的に受注情報の取得処理を試みたのですが、データ量によってはサーバーが落ちてしまうことがありました。改善方針として更新対象のデータの期間を狭くすることも考えられましたが、徐々にユーザーの販売規模が増えていることから今後のパフォーマンス面も鑑みて、非同期かつバックグラウンドで実行できるように別サーバーで処理する方針としました。
<br>該当コードへのリンクは[こちら](https://github.com/masaengineer/parts-sync-app/blob/main/app/controllers/csv_imports_controller.rb)
</details>

[![Image from Gyazo](https://i.gyazo.com/5fb5078493a916a67b9e1dcd23478287.gif)](https://gyazo.com/5fb5078493a916a67b9e1dcd23478287)

</td>
<td width="50%">

#### 🔍 フィルタリング機能

<details>
<summary>詳細（クリックして表示）</summary>
強力な検索ライブラリであるRansackを活用し、販売データを日付範囲、注文番号、追跡番号、SKUコードといった複数のキーで柔軟にフィルタリングできる機能を実装しました。特に、関連テーブル（`order_lines`, `seller_skus`）を含む検索結果表示において、N+1問題を回避するため`includes`メソッドによるEager Loadingを徹底しています。さらに、JOINに伴う重複レコードを除去するため`.result(distinct: true)`を適用し、データの正確性を担保しました。検索パフォーマンス向上のため、頻繁に検索対象となるカラムにはデータベースインデックスを適切に設定しています。UI面では、アイコンやプレースホルダーを効果的に使用することで、直感的でミニマルなインターフェースを実現し、ユーザーが必要な情報へ素早くアクセスできるよう工夫しました。
<br>該当コードへのリンクは[こちら](https://github.com/masaengineer/parts-sync-app/blob/main/app/controllers/orders_controller.rb)
</details>

[![Image from Gyazo](https://i.gyazo.com/c39aaff5e467c1b1c1f93d1f86959412.gif)](https://gyazo.com/c39aaff5e467c1b1c1f93d1f86959412)

</td>
</tr>
<tr>
<td width="50%">

#### 📝 オーダー詳細 & 価格調整メモ機能

<details>
<summary>詳細（クリックして表示）</summary>
Hotwire（Turbo Frames/Streams & Stimulus）の機能を最大限に活用し、商品一覧画面からページ遷移することなく、シームレスにモーダルウィンドウで注文詳細を表示し、価格調整メモを登録できる機能を実装しました。Turbo Streamsを用いることで、メモ登録後にページ全体を再読み込みすることなく、リアルタイムに一覧画面の価格調整日バッジを更新し、ユーザーに即時フィードバックを提供します。HTML標準の`<dialog>`要素とStimulusコントローラーを組み合わせることで、モーダル表示のロジックをシンプルに保ちつつ、ESCキー押下やモーダル外クリックによるクローズといったUXにも配慮しました。これにより、SPA（Single Page Application）のような滑らかな操作感と、Railsの生産性の高さを両立させています。
<br>該当コードへのリンクは[こちら](https://github.com/masaengineer/parts-sync-app/blob/main/app/controllers/price_adjustments_controller.rb)
</details>

[![Image from Gyazo](https://i.gyazo.com/86e1fcede5b99059502eb51146b6caf3.gif)](https://gyazo.com/86e1fcede5b99059502eb51146b6caf3)

</td>
<td width="50%">

#### 💰 経費入力機能

<details>
<summary>詳細（クリックして表示）</summary>
商品ごとの直接的な利益計算には含めないものの、月次レポートでの集計が必要となる間接的な経費項目を手動で入力・管理できる機能です。入力フォームにはバリデーションを設定し、データの整合性を担保するとともに、直感的なUIで入力作業の負担を軽減しています。また、一部の委託費用については、販売情報取り込み機能（CSVインポート）と連携し、インポート時に自動的に経費データとして登録される仕組みを構築しました。これにより、手入力の手間を省き、ヒューマンエラーを削減しています。登録された経費データは月次レポート機能と連携し、正確な収支計算に貢献します。
<br>該当コードへのリンクは[こちら](https://github.com/masaengineer/parts-sync-app/blob/main/app/controllers/monthly_reports/expenses_controller.rb)
</details>

[![Image from Gyazo](https://i.gyazo.com/e428dcbca255851103774bf2cc259800.gif)](https://gyazo.com/e428dcbca255851103774bf2cc259800)

</td>
</tr>
<tr>
<td width="50%">

#### 🎯 オンラインツアーガイド機能

<details>
<summary>詳細（クリックして表示）</summary>
初回訪問したユーザーに対してすぐに使い方がわかるように、JavaScriptライブラリ`tourguide.js`を導入し、主要機能を紹介するインタラクティブなオンラインツアーを提供しています。このツアーは、ユーザーが初めてログインした際に自動的に開始され、各機能の目的や操作方法をステップバイステップで視覚的に案内します。ツアーの進捗状況は`localStorage`に保存され、ユーザーが途中で中断しても次回ログイン時に続きから再開できるよう配慮しました。この機能により、初期の学習コストを低減し、ユーザーオンボーディングを効果的に支援することで、サービスへの定着率向上を目指しています。
<br>該当コードへのリンクは[こちら](https://github.com/masaengineer/parts-sync-app/blob/main/app/javascript/controllers/tour_controller.js)
</details>

[![Image from Gyazo](https://i.gyazo.com/a2b15bd487d7a6200caee2719c018a15.gif)](https://gyazo.com/a2b15bd487d7a6200caee2719c018a15)

</td>
<td width="50%">
</td>
</tr>
</table>
<br>

## 使用技術

| カテゴリ           | 技術                                               |
| ------------------ | -------------------------------------------------- |
| **バックエンド**   | Ruby 3.3.6 / Ruby on Rails 7.2.2.1                 |
| **フロントエンド** | Hotwire（Turbo・stimulus）/ Tailwind CSS / DaisyUI |
| **データベース**   | PostgreSQL                                         |
| **インフラ**       | Render                                             |
| **キャッシュ**     | Redis                                              |
| **キューイング**   | Sidekiq / Sidekiq-scheduler                        |
| **テスト**         | RSpec / FactoryBot / Capybara / SimpleCov          |
| **CI/CD**          | GitHub Actions                                     |
| **認証・認可**     | Devise / OmniAuth (Google OAuth2)                  |
| **API 通信**       | Faraday / OAuth2                                   |
| **UI/UX 機能**     | Kaminari（ページネーション）/ Ransack（検索機能）  |
| **国際化**         | Rails-i18n                                         |
| **コンテナ化**     | Docker / Docker Compose                            |
| **セキュリティ**   | Brakeman / Bundler-audit                           |
| **開発ツール**     | Rubocop / Overcommit                               |

<br>

## ER 図

![ER図](https://github.com/user-attachments/assets/334b6fdf-c923-4ef1-95d1-e3e0b94cc6df)

[拡大画像はこちらからご覧いただけます](https://drive.google.com/file/d/1jV2wuRPjwQDTHUo5-jW0aZx39QOyl428/view?usp=sharing)

<br>

## データベース構成

※ ✅ はそのテーブルがどの機能で使用されているかを示しています

| テーブル名        | 説明                                       | **売上レポート** | **月次レポート** |
| ----------------- | ------------------------------------------ | :--------------: | :--------------: |
| users             | 当アプリのユーザー情報を管理               |        ✅        |        ✅        |
| orders            | 注文の基本情報を管理                       |        ✅        |        ✅        |
| order_lines       | 注文の明細情報を管理                       |        ✅        |        ✅        |
| seller_skus       | 販売者側の商品コード情報を管理             |        ✅        |                  |
| manufacturer_skus | メーカー側の商品コード情報を管理           |        ✅        |                  |
| sku_mappings      | メーカーと販売者の商品コードの中間テーブル |        ✅        |                  |
| manufacturers     | メーカー情報を管理                         |        ✅        |                  |
| price_adjustments | 商品価格の調整履歴を管理                   |        ✅        |                  |
| sales             | 売上情報を管理                             |        ✅        |        ✅        |
| procurements      | 仕入れ情報を管理                           |        ✅        |        ✅        |
| shipments         | 配送情報を管理                             |        ✅        |        ✅        |
| payment_fees      | 決済手数料情報を管理                       |        ✅        |        ✅        |
| currencies        | 通貨情報を管理（USD、EUR、GBP など）       |        ✅        |        ✅        |
| expenses          | 月次経費情報を管理                         |                  |        ✅        |
